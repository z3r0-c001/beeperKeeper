# MediaMTX Configuration for Beeper Keeper v2.0
# Optimized for HLS streaming with both cameras at native resolutions

# API
api: yes
apiAddress: :9997

# WebRTC - Ultra low latency streaming (0.5-2 seconds)
webrtc: yes
webrtcAddress: :8889
webrtcICEServers2: []

# HLS - Balanced for reliability and moderate latency
# FIXED: Reduced segment count from 40 to 6 (was causing 80s buffer)
# FIXED: Increased segment duration from 2s to 4s (fewer HTTP requests)
# FIXED: Changed variant from lowLatency to mpegts (traditional HLS - most compatible)
# FIXED: Increased part duration from 500ms to 1s (less overhead)
hls: yes
hlsAddress: :8888
hlsAlwaysRemux: yes
hlsVariant: mpegts
hlsSegmentCount: 6
hlsSegmentDuration: 4s
hlsPartDuration: 1s
hlsSegmentMaxSize: 50M

# RTSP backend
rtspAddress: :8554
protocols: [tcp]
encryption: "no"

# Performance tuning
readTimeout: 20s
writeTimeout: 20s

# Camera streams
paths:
  # CSI Camera (OV5647 IR) - 1920x1080 @ 30fps with hardware H.264
  csi_camera:
    runOnInit: /opt/beeperKeeper/config/start_csi_camera.sh
    runOnInitRestart: yes

  # USB Webcam (eMeet C980 Pro 4K) - 800x600 @ 15fps with H.264 + AAC audio
  usb_camera:
    runOnInit: /opt/beeperKeeper/config/start_usb_camera.sh
    runOnInitRestart: yes
